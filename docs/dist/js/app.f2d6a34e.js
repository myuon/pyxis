(function(t){function e(e){for(var i,s,r=e[0],l=e[1],c=e[2],m=0,d=[];m<r.length;m++)s=r[m],a[s]&&d.push(a[s][0]),a[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,r=1;r<n.length;r++){var l=n[r];0!==a[l]&&(i=!1)}i&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},a={app:0},o=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/pyxis/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var i=n("c21b"),a=n.n(i);a.a},"212c":function(t,e,n){"use strict";var i=n("9db4"),a=n.n(i);a.a},"56d7":function(t,e,n){"use strict";n.r(e);var i=n("2b0e"),a=n("8c4f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[t._l(t.recent,function(e){return n("div",{key:e.id,staticStyle:{"margin-bottom":"1rem"}},[n("h3",[t._v(t._s(e.title)+" ("+t._s(e.tickets.length)+")")]),n("el-table",{staticStyle:{"margin-bottom":"1rem"},attrs:{data:e.tickets}},[n("el-table-column",{attrs:{prop:"id",label:"id"}}),n("el-table-column",{attrs:{prop:"title",label:"title"}}),n("el-table-column",{attrs:{prop:"comment",label:"comment"}}),n("el-table-column",{attrs:{prop:"id"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){t.$router.push("/tickets/"+e.row.id)}}},[t._v("Open")])]}}])})],1),n("el-button",{attrs:{type:"default",icon:"el-icon-plus",size:"small"},on:{click:function(n){t.newTicketDialog=!0,t.selectingProject=e.id}}},[t._v("New Ticket")]),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(n){t.deleteProject(e.id)}}},[t._v("Delete")])],1)}),n("el-dialog",{attrs:{title:"Create New Ticket",visible:t.newTicketDialog,width:"60%","before-close":t.handleClose},on:{"update:visible":function(e){t.newTicketDialog=e}}},[n("el-form",{attrs:{model:t.projectForm,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"Ticket Title"}},[n("el-input",{attrs:{placeholder:"Title"},model:{value:t.ticketForm.title,callback:function(e){t.$set(t.ticketForm,"title",e)},expression:"ticketForm.title"}})],1),n("el-form-item",{attrs:{label:"Assigned to"}},[n("el-select",{attrs:{multiple:"",placeholder:"Select"},model:{value:t.ticketForm.assigned_to,callback:function(e){t.$set(t.ticketForm,"assigned_to",e)},expression:"ticketForm.assigned_to"}})],1),n("el-form-item",{attrs:{label:"Deadline"}},[n("el-date-picker",{attrs:{type:"date",placeholder:"Pick a day"},model:{value:t.ticketForm.deadline,callback:function(e){t.$set(t.ticketForm,"deadline",e)},expression:"ticketForm.deadline"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.newTicketDialog=!1}}},[t._v("Cancel")]),n("el-button",{attrs:{type:"primary",disabled:""==t.ticketForm.title},on:{click:t.createTicket}},[t._v("Confirm")])],1)],1),n("div",[n("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(e){t.newProjectDialog=!0}}},[t._v("New Project")]),n("el-dialog",{attrs:{title:"Create New Project",visible:t.newProjectDialog,width:"40%","before-close":t.handleClose},on:{"update:visible":function(e){t.newProjectDialog=e}}},[n("el-form",{attrs:{model:t.projectForm,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"Project Name"}},[n("el-input",{attrs:{placeholder:"Project Name"},model:{value:t.projectForm.title,callback:function(e){t.$set(t.projectForm,"title",e)},expression:"projectForm.title"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.newProjectDialog=!1}}},[t._v("Cancel")]),n("el-button",{attrs:{type:"primary",disabled:""==t.projectForm.title},on:{click:t.createProject}},[t._v("Confirm")])],1)],1)],1)],2)},s=[],r=n("faa3"),l={name:"home",data(){return{recent:[],newProjectDialog:!1,projectForm:{title:""},newTicketDialog:!1,selectingProject:"",ticketForm:{title:"",assigned_to:[],deadline:null}}},methods:{handleClose:async function(t){await this.$confirm("Are you sure to close this dialog?"),t()},createProject:async function(){await r["client"].project.create({title:this.projectForm.title,owned_by:"1"});await this.loadRecentProjects(),this.newProjectDialog=!1,this.projectForm.title=""},deleteProject:async function(t){await r["client"].project.remove(t),await this.loadRecentProjects()},loadRecentProjects:async function(){this.recent=await r["client"].project.listRecent()},createTicket:async function(){await r["client"].ticket.create({title:this.ticketForm.title,assigned_to:this.ticketForm.assigned_to,deadline:this.ticketForm.deadline,belongs_to:{project:this.selectingProject},owned_by:"1"});await this.loadRecentProjects(),this.newTicketDialog=!1,this.ticketForm={title:"",assigned_to:[],deadline:null}}},mounted:async function(){await this.loadRecentProjects()}},c=l,u=(n("81cf"),n("2877")),m=Object(u["a"])(c,o,s,!1,null,"7abe5540",null);m.options.__file="Home.vue";var d=m.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[null!=t.ticket.id?n("span",[t._v(t._s(t.ticket.belongs_to.project)+" > #"+t._s(t.ticket.id))]):t._e(),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){t.$router.push("/")}}},[t._v("Back to List")])],1),n("h2",[t._v(t._s(t.ticket.title))]),n("el-collapse",{staticClass:"ticket-data",model:{value:t.active_tabs,callback:function(e){t.active_tabs=e},expression:"active_tabs"}},[n("el-collapse-item",{attrs:{name:"1"}},[n("template",{slot:"title"},[n("span",{staticClass:"collapse-title"},[t._v("Ticket Data")])]),n("div",{staticClass:"form-control"},[n("span",[t._v("Ticket number")]),n("el-input",{attrs:{disabled:""},model:{value:t.ticket.id,callback:function(e){t.$set(t.ticket,"id",e)},expression:"ticket.id"}})],1),n("div",{staticClass:"form-control"},[n("span",[t._v("Assigned to")]),n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:"Select"},model:{value:t.ticket.assigned_to,callback:function(e){t.$set(t.ticket,"assigned_to",e)},expression:"ticket.assigned_to"}},t._l(t.members,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),n("div",{staticClass:"form-control"},[n("span",[t._v("Deadline")]),n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Pick a day"},model:{value:t.ticket.deadline,callback:function(e){t.$set(t.ticket,"deadline",e)},expression:"ticket.deadline"}})],1)],2),n("el-collapse-item",{attrs:{name:"2"}},[n("template",{slot:"title"},[n("span",{staticClass:"collapse-title"},[t._v("Content")])]),n("el-tabs",{model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}},t._l(t.pages,function(e,i){return n("el-tab-pane",{key:i,attrs:{label:e.title,name:i.toString()}},[n("div",{staticClass:"float"},[n("el-button-group",{staticClass:"markdown-mode"},[n("el-button",{class:{current:t.isView},attrs:{type:"default",size:"mini"},on:{click:function(e){t.setMode("view")}}},[n("i",{staticClass:"material-icons"},[t._v("visibility")])]),n("el-button",{class:{current:t.isEdit},attrs:{type:"default",size:"mini"},on:{click:function(e){t.setMode("edit")}}},[n("i",{staticClass:"material-icons"},[t._v("edit")])])],1)],1),"edit"===t.md_mode?n("el-input",{attrs:{type:"textarea",rows:15,placeholder:"Please input"},model:{value:e.content,callback:function(n){t.$set(e,"content",n)},expression:"page.content"}}):t._e(),"view"===t.md_mode?n("vue-markdown",{staticClass:"markdown-view",attrs:{source:e.content}}):t._e()],1)}))],2),n("el-collapse-item",{attrs:{name:"3"}},[n("template",{slot:"title"},[n("span",{staticClass:"collapse-title"},[t._v("Comments")])]),t._l(t.comments,function(e){return n("el-row",{key:e.id,staticClass:"comment-feed",attrs:{justify:"space-between"}},[n("div",{staticClass:"meta"},[n("span",{staticClass:"timestamp"},[t._v("#"+t._s(e.id)+" ["+t._s(e.created_at)+"]")])]),n("el-col",{staticClass:"icon",attrs:{span:1}},[n("i",{staticClass:"material-icons"},[t._v("person")])]),n("el-col",{attrs:{offset:1,span:11}},[n("div",{staticClass:"comment"},[n("span",{staticClass:"summary"},[t._v("@"+t._s(e.owner)+" commented:")]),n("vue-markdown",{attrs:{source:e.content}})],1)])],1)}),n("el-row",[n("el-col",{staticClass:"icon",attrs:{span:1}},[n("i",{staticClass:"material-icons"},[t._v("person")])]),n("el-col",{attrs:{offset:1,span:11}},[n("div",{staticClass:"comment"},[n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"Please input"},model:{value:t.newCommentText,callback:function(e){t.newCommentText=e},expression:"newCommentText"}}),n("el-button",{attrs:{type:"success",size:"small"},on:{click:t.submitComment}},[t._v("Submit")])],1)])],1)],2)],1),n("el-button",{staticStyle:{"margin-top":"1rem","margin-bottom":"1rem",float:"right"},attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:t.deleteTicket}},[t._v("Delete")])],1)],1)},f=[],v=n("9ce6"),g=n.n(v),h={name:"ticket",components:{VueMarkdown:g.a},computed:{isView(){return"view"===this.md_mode},isEdit(){return"edit"===this.md_mode}},data(){return{members:[{value:"1",label:"わたし"},{value:"2",label:"あなた"},{value:"3",label:"かれ"}],currentPage:"0",md_mode:"view",active_tabs:["1","2","3"],ticket:{},comments:[],pages:[],newCommentText:""}},methods:{setMode(t){this.md_mode=t},submitComment:async function(){await r["client"].comment.create({content:this.newCommentText,belongs_to:{project:this.ticket.belongs_to,ticket:this.$route.params.ticketId},owned_by:"1"}),this.newCommentText="",await this.loadComments()},loadComments:async function(){this.comments=await r["client"].comment.list(this.$route.params.ticketId)},deleteTicket:async function(){await r["client"].ticket.remove(this.ticket.id),this.$router.push("/")}},mounted:async function(){this.ticket=await r["client"].ticket.get(this.$route.params.ticketId),await this.loadComments(),this.pages=(await r["client"].page.list(this.$route.params.ticketId)).map(t=>{return t.content=null==t.content?"":t.content,t})}},b=h,_=(n("eb52"),Object(u["a"])(b,p,f,!1,null,"7b6df16f",null));_.options.__file="Ticket.vue";var k=_.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"center"},[n("el-card",{staticClass:"box-card"},[n("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"Sign In",name:"signIn"}},[n("g-signin-button",{attrs:{params:t.googleSignInParams},on:{success:t.onSignInSuccess,error:t.onSignInError}},[n("el-button",{attrs:{type:"primary"}},[t._v("\n            Sign in with Google\n          ")])],1)],1),n("el-tab-pane",{attrs:{label:"Sign Up",name:"signUp"}},[n("el-form",{ref:"form",attrs:{rules:t.formRules,model:t.form,"label-width":"100px","status-icon":""}},[n("el-form-item",{attrs:{label:"User Name",prop:"user_name"}},[n("el-input",{attrs:{size:"small",autocomplete:"off"},model:{value:t.form.user_name,callback:function(e){t.$set(t.form,"user_name",e)},expression:"form.user_name"}},[n("template",{slot:"prepend"},[t._v("@")])],2)],1),n("el-form-item",[n("g-signin-button",{attrs:{params:t.googleSignInParams},on:{success:t.onSignUpSuccess,error:t.onSignUpError}},[n("el-button",{attrs:{type:"primary"}},[t._v("\n                Sign up with Google\n              ")])],1)],1)],1)],1)],1)],1)],1)},y=[],C=n("65fb"),x={name:"login",components:{},data(){const t=async(t,e,n)=>{if(""===e)n(new Error("Please input the user name"));else{const t=await r["client"].auth.userNameAvailable(this.form.user_name);t||n(new Error("This user name is not available")),n()}};return{activeTab:"signIn",authConfig:{},googleSignInParams:{client_id:C.web.client_id},form:{user_name:""},formRules:{user_name:[{validator:t,trigger:"change"}]}}},methods:{onSignUpSuccess:async function(t){const e=await r["client"].auth.signUp({user_name:this.form.user_name,token:t.getAuthResponse().id_token});!0===e.result&&await this.onSignInSuccess(t)},onSignUpError(t){console.log(t)},onSignInSuccess:async function(t){await r["client"].auth.signIn({token:t.getAuthResponse().id_token}),this.$router.push("/")},onSignInError(t){console.log(t)}}},S=x,j=(n("212c"),Object(u["a"])(S,w,y,!1,null,"6aa78385",null));j.options.__file="Signin.vue";var P=j.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-menu",{staticClass:"side-menu",attrs:{"default-active":"2","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[n("h2",{staticClass:"logo"},[n("i",{staticClass:"material-icons"},[t._v("my_location")]),n("router-link",{attrs:{to:"/"}},[t._v("Pyxis")])],1),n("div",{staticClass:"login-state"},[n("i",{staticClass:"material-icons"},[t._v("person_pin")]),n("div",{staticClass:"user"},[t._v("\n      Login as "+t._s(t.user.user_name)+"\n      "),n("button",{staticClass:"action",attrs:{type:"mini"},on:{click:t.signOut}},[t._v("Sign out")])])]),n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-location"}),n("span",[t._v("Documents")])]),n("el-menu-item-group",{attrs:{title:"Group One"}},[n("el-menu-item",{attrs:{index:"1-1"}},[t._v("item one")]),n("el-menu-item",{attrs:{index:"1-2"}},[t._v("item one")])],1),n("el-menu-item-group",{attrs:{title:"Group Two"}},[n("el-menu-item",{attrs:{index:"1-3"}},[t._v("item three")])],1),n("el-submenu",{attrs:{index:"1-4"}},[n("template",{slot:"title"},[t._v("item four")]),n("el-menu-item",{attrs:{index:"1-4-1"}},[t._v("item one")])],2)],2),n("el-menu-item",{attrs:{index:"2"}},[n("i",{staticClass:"el-icon-menu"}),n("span",[t._v("Navigator Two")])]),n("el-menu-item",{attrs:{index:"3",disabled:""}},[n("i",{staticClass:"el-icon-document"}),n("span",[t._v("Navigator Three")])]),n("el-menu-item",{attrs:{index:"4"}},[n("i",{staticClass:"el-icon-setting"}),n("span",[t._v("Navigator Four")])])],1)},$=[],F={name:"side-bar",data(){return{user:{}}},mounted:async function(){this.user=await r["client"].user.me(),"Unauthorized"===this.user.message&&this.$router.push("/signIn")},methods:{signOut:async function(){this.user=null,document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:01 GMT;",this.$router.push("/signin")}}},I=F,O=Object(u["a"])(I,T,$,!1,null,null,null);O.options.__file="SideBar.vue";var N=O.exports;i["default"].use(a["a"]);var D=new a["a"]({mode:"history",base:"/pyxis/",routes:[{path:"/",name:"home",components:{default:d,sidebar:N}},{path:"/tickets/:ticketId",name:"ticket",components:{default:k,sidebar:N}},{path:"/signin",name:"signin",components:{default:P}}]}),A=n("5c96"),R=n.n(A),z=(n("0fae"),n("c789"),n("4f76")),E=n.n(z),U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("el-container",[n("el-aside",{staticClass:"sidebar"},[n("router-view",{attrs:{name:"sidebar"}})],1),n("el-main",{staticClass:"main"},[n("router-view")],1)],1)],1)},M=[],J={data(){return{activeItem:"Home"}},mounted:async function(){}},q=J,B=(n("034f"),Object(u["a"])(q,U,M,!1,null,null,null));B.options.__file="App.vue";var G=B.exports;i["default"].use(R.a),i["default"].use(g.a),i["default"].use(E.a),i["default"].config.productionTip=!1,new i["default"]({router:D,render:t=>t(G)}).$mount("#app")},"65fb":function(t){t.exports={web:{client_id:"568268689599-qkm82j7p21uhfrv0a3qulepped825s85.apps.googleusercontent.com",project_id:"pyxis-222412",auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://www.googleapis.com/oauth2/v3/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_secret:"6AAi4MfT_aAVIP3hFx1tbiRf",redirect_uris:["http://localhost:8080"],javascript_origins:["http://localhost:8080"]}}},"7ac8":function(t,e,n){},"81cf":function(t,e,n){"use strict";var i=n("c5fa"),a=n.n(i);a.a},"9db4":function(t,e,n){},c21b:function(t,e,n){},c5fa:function(t,e,n){},eb52:function(t,e,n){"use strict";var i=n("7ac8"),a=n.n(i);a.a},faa3:function(t,e,n){"use strict";var i=n("5839"),a=n("dfcb"),o=n("bd60"),s=n("2361"),r="https://k1dt1bsvp1.execute-api.ap-northeast-1.amazonaws.com/dev";function l(t){var e=s.getAsString("token");return fetch(String(r)+(String(t)+""),i.RequestInit[0](0,o.some(a.isNone(e)?[]:{Authorization:"Bearer "+String(e)}),void 0,void 0,void 0,void 0,1,void 0,void 0,void 0,void 0)(0)).then(function(t){return t.text()}).then(function(t){return Promise.resolve(JSON.parse(t))})}function c(t){var e=s.getAsString("token");return fetch(String(r)+(String(t)+""),i.RequestInit[0](4,o.some(a.isNone(e)?[]:{Authorization:"Bearer "+String(e)}),void 0,void 0,void 0,void 0,1,void 0,void 0,void 0,void 0)(0)).then(function(t){return t.text()}).then(function(t){return Promise.resolve(JSON.parse(t))})}function u(t,e){var n=s.getAsString("token");return fetch(String(r)+(String(t)+""),i.RequestInit[0](2,o.some(a.isNone(n)?[]:{Authorization:"Bearer "+String(n)}),o.some(JSON.stringify(e)),void 0,void 0,void 0,1,void 0,void 0,void 0,void 0)(0)).then(function(t){return t.text()}).then(function(t){return Promise.resolve(JSON.parse(t))})}var m={auth:{signIn:function(t){return u("/auth/signIn",t).then(function(t){return s.setString("token",t.token),Promise.resolve(t)})},signUp:function(t){return u("/auth/signUp",t)},userNameAvailable:function(t){return l("/auth/user_name/is_available/"+String(t))}},user:{me:function(t){return l("/users/me")}},ticket:{create:function(t){return u("/tickets/",t)},get:function(t){return l("/tickets/"+String(t))},remove:function(t){return c("/tickets/"+String(t))}},comment:{list:function(t){return l("/tickets/"+String(t)+"/comments")},create:function(t){return u("/comments/",t)}},page:{list:function(t){return l("/tickets/"+String(t)+"/pages")}},project:{create:function(t){return u("/projects/",t)},listRecent:function(t){return l("/projects/recent")},remove:function(t){return c("/projects/"+String(t))}}};e.endpoint=r,e.get=l,e.$$delete=c,e.post=u,e.client=m}});
//# sourceMappingURL=app.f2d6a34e.js.map